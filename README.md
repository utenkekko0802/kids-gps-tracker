# 子供用GPS通信デバイス

手のひらサイズの見守りデバイス自作プロジェクト

## 📖 概要

フリーSIMとローカルLLMを活用し、子供に持たせる手のひらサイズのGPS通信デバイスを自作します。
市販の見守りGPSにはない音声メッセージ機能を実装し、親子間のコミュニケーションを実現します。

## ✨ 主な機能

### Phase 1: GPS位置情報送信（MVP）
- 📍 5分間隔でGPS座標を自動取得・送信
- 📱 親のLINEに位置情報通知
- 🔘 手動送信ボタン
- 🔋 バッテリー残量監視・警告
- 💡 受信確認LED

### Phase 2: 音声メッセージ機能
- 🎤 音声録音（10秒）
- 📤 音声→テキスト変換（Whisper API）
- 💬 LINEへテキスト送信
- 🔊 LINE返信の音声読み上げ
- 🔔 受信通知

### Phase 3: LLM判定機能
- 🤖 緊急度判定（Llama 3.2）
- ⚠️ 緊急語句の優先通知
- 📝 メッセージ要約

### Phase 4: Qi充電化（最終形態）
- 🔌 非接触充電（置くだけ充電）
- 🧲 磁石ガイドで自動位置合わせ
- 💧 防水性向上

## 🛠️ 技術スタック

### ハードウェア
- **メインボード:** ESP32-DevKitC V4
- **通信モジュール:** SIM7080G（LTE Cat-M/NB-IoT + GPS）
- **バッテリー:** 3.7V 3,000mAh LiPo
- **音声:** MAX9814マイク + MAX98357Aアンプ
- **充電:** Qi非接触充電（磁石ガイド付き）

### ソフトウェア
- **デバイス:** C++ (Arduino Framework)
- **サーバー:** TypeScript + Next.js 14
- **ホスティング:** Vercel (Serverless Functions)
- **データベース:** Supabase (PostgreSQL)
- **外部API:** OpenAI Whisper API, LINE Messaging API

### 通信
- **SIMキャリア:** IIJmio データeSIM（440円/月）
- **データ容量:** 2GB/月

## 💰 コスト

### 初期費用
- Phase 1（GPS基本機能）: 約13,000円
- Phase 2（音声機能）: +2,300円
- Phase 4（Qi充電化）: +3,200円
- **合計: 約18,500円**

### 月額費用
- IIJmio SIM: 440円
- Whisper API: 約100円（音声メッセージ月90回想定）
- **合計: 約540円/月**

## 🔋 バッテリー性能

- **駆動時間:** 約7-10日間（週1充電）
- **省電力設計:** Deep Sleep実装、通信の間欠動作
- **充電時間:** 約3時間（Qi充電時）

## 📅 開発スケジュール

| Phase | 内容 | 期間 |
|-------|------|------|
| Phase 1 | GPS位置情報送信（MVP） | 約2週間 |
| Phase 2 | 音声メッセージ機能 | 約2週間 |
| Phase 3 | LLM判定機能 | 約1週間 |
| Phase 4 | Qi充電化 | 約2週間 |

## 📚 ドキュメント

- [要件定義書](./docs/requirements.md)
- [部品リスト](./docs/parts-list.md)
- [セットアップガイド](./docs/setup-guide.md)
- [API仕様書](./docs/api-spec.md)

## 🚀 クイックスタート

### 1. 部品の準備
[部品リスト](./docs/parts-list.md)を参照して必要な部品を調達してください。

### 2. 開発環境のセットアップ
```bash
# Arduino IDE のインストール
# ESP32 ボードマネージャの追加
# 必要なライブラリのインストール
```

詳細は[セットアップガイド](./docs/setup-guide.md)を参照してください。

### 3. サーバーのセットアップ
```bash
cd server
npm install
npm run dev
```

### 4. デバイスのビルド＆書き込み
```bash
# Arduino IDE でデバイスコードを開く
# ESP32に接続
# ビルド＆アップロード
```

## 📖 使い方

1. **デバイスの起動**
   - 電源を入れると自動的にGPS測位開始
   - 5分間隔で位置情報をサーバーに送信

2. **手動で位置送信**
   - 送信ボタンを押すと即座に位置情報を送信

3. **音声メッセージ送信（Phase 2以降）**
   - 送信ボタンを長押しして録音開始
   - 10秒間話す
   - 自動的にテキスト変換されてLINEに送信

4. **返信の受信**
   - LINEで返信すると受信LEDが点灯
   - 再生ボタンを押すと音声で読み上げ

5. **充電（Phase 4以降）**
   - Qi充電パッドに置くだけ
   - 磁石で自動的に位置合わせ

## ⚠️ 注意事項

- 技適認証済みのモジュールを使用してください
- GPS測位には屋外での使用を推奨します
- バッテリー残量20%以下で充電してください
- 防水ケースの使用を推奨します

## 🤝 コントリビューション

このプロジェクトは個人の学習・開発用ですが、フィードバックやアイデアは歓迎します。
IssueやPull Requestをお待ちしています。

## 📄 ライセンス

MIT License

## 📧 連絡先

質問や提案がある場合は、Issueを作成してください。

---

**プロジェクト開始日:** 2026年1月21日  
**最終更新日:** 2026年1月21日
